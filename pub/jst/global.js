var Global;

Global = {
  astroInterval: false,
  fbarInterval: false,
  phraseTimeout: false,
  phraseInterval: false,
  thumbTimeout: false,
  cache: {},
  i: function() {
    NProgress.configure({
      showSpinner: false
    });
    Global.cache.astro = $('.astro');
    Global.cache.red1 = $('.red1');
    Global.cache.burger = $('.top > .inner > .burger > .inner');
    Global.cache.phrase = $('.top > .inner > .phrase');
    setTimeout(function() {
      return Global.astro(true);
    }, 400);
    Global.astroInterval = setInterval(function() {
      return Global.astro();
    }, 500);
    if ($(window).width() > 1000) {
      Global.fbarInterval = setInterval(function() {
        return Global.fbar();
      }, 20);
    }
    Global.handlers();
    if ($(window).width() > 1000) {
      return Global.fbar();
    }
  },
  fbar: function() {
    if ($('.fcontainer:visible').length === 0) {
      return true;
    }
    if ($(window).scrollTop() > ($('.fcontainer:visible').offset().top)) {
      return $('.filters').addClass('float');
    } else {
      return $('.filters').removeClass('float');
    }
  },
  handlers: function() {
    $('.top > .inner > .burger').on('click', Global.burger);
    $('.menu > .inner > .options > .option').on('click', Global.option);
    $('.thumbs > .thumb, .projects > .thumb, .related > .inner > .relateds > .thumb').on('mousemove', Global.thumb);
    return $('.footer > .inner > .gravity, .footer > .inner > .manifesto > .inner > .close').on('click', Global.manifesto);
  },
  manifesto: function() {
    var mf;
    mf = $('.manifesto');
    if (mf.hasClass('on')) {
      return _.off(mf);
    } else {
      return _.on(mf);
    }
  },
  thumb: function(event) {
    var bg, distortBg, distortFilters, distortName, filters, filtersRect, name, nameRect, offset, opx4, opx6, opx8, opy4, opy6, opy8, px, py, rect, t, x, y;
    t = $(this);
    bg = t.find('.inner');
    name = t.find('.inner > .bg > .copy > .name');
    filters = t.find('.inner > .bg > .copy > .filters');
    rect = t[0].getBoundingClientRect();
    nameRect = name[0].getBoundingClientRect();
    filtersRect = filters[0].getBoundingClientRect();
    distortBg = new Distort({
      width: rect.width,
      height: rect.height,
      $el: bg
    });
    distortName = new Distort({
      width: rect.width,
      height: rect.height,
      $el: nameRect
    });
    distortFilters = new Distort({
      width: rect.width,
      height: rect.height,
      $el: filtersRect
    });
    offset = t.offset();
    x = Math.floor(event.pageX - offset.left);
    y = Math.floor(event.pageY - offset.top);
    px = Math.floor(x * 100 / t.width());
    py = Math.floor(y * 100 / t.height());
    opx8 = (px - 50) / 8;
    opy8 = (py - 50) / 8;
    opx6 = (px - 50) / 4;
    opy6 = (py - 50) / 4;
    opx4 = (px - 50) / 4;
    opy4 = (py - 50) / 4;
    distortBg.topRight.x -= opy8;
    distortBg.topRight.y -= opx8;
    distortBg.topLeft.x -= -opy8;
    distortBg.topLeft.y -= -opx8;
    distortBg.bottomRight.x -= -opy8;
    distortBg.bottomRight.y -= -opx8;
    distortBg.bottomLeft.x -= opy8;
    distortBg.bottomLeft.y -= opx8;
    bg.css('transform', distortBg.toString());
    distortName.topRight.x -= opy4;
    distortName.topRight.y -= opx4;
    distortName.topLeft.x -= -opy4;
    distortName.topLeft.y -= -opx4;
    distortName.bottomRight.x -= -opy4;
    distortName.bottomRight.y -= -opx4;
    distortName.bottomLeft.x -= opy4;
    distortName.bottomLeft.y -= opx4;
    name.css('transform', distortName.toString());
    distortFilters.topRight.x -= opy6;
    distortFilters.topRight.y -= opx6;
    distortFilters.topLeft.x -= -opy6;
    distortFilters.topLeft.y -= -opx6;
    distortFilters.bottomRight.x -= -opy6;
    distortFilters.bottomRight.y -= -opx6;
    distortFilters.bottomLeft.x -= opy6;
    distortFilters.bottomLeft.y -= opx6;
    return filters.css('transform', distortFilters.toString());
  },

  /*
  phrase: ->
    phrase = phrases[Math.floor(Math.random()*phrases.length)]
    compiled = ''
    for i in [0..(phrase.length-1)]
      compiled  = "#{compiled}<div>#{phrase[i].replace(' ', '&nbsp;')}</div>"
  
    Global.cache.phrase.html compiled
  
    Global.phraseTimeout = setTimeout ->
      _.on Global.cache.phrase
    , 5000
   */
  phrase: function() {
    var char, charDuration, chars, counter, duration, nums, numsMax, phrase, text;
    phrase = phrases[Math.floor(Math.random() * phrases.length)];
    duration = 2000;
    chars = phrase.length;
    charDuration = Math.round(duration / chars);
    char = 0;
    counter = 0;
    nums = ['!', '@', '_', '#', '%', '^', '&', '*', '_', '(', ')', '[', ']', '_'];
    numsMax = nums.length - 1;
    Global.cache.phrase.text('');
    text = '';
    Global.phraseInterval = setInterval(function() {
      counter++;
      if (counter === 10) {
        Global.cache.phrase.text("" + text + phrase[char++]);
        text = Global.cache.phrase.text();
        counter = 0;
      } else {
        Global.cache.phrase.text("" + text + nums[_.rand(0, numsMax)]);
      }
      if (char === chars) {
        return clearInterval(Global.phraseInterval);
      }
    }, charDuration / 10);
    console.log(duration, phrase.length, charDuration, phrase);
    return Global.phraseTimeout = setTimeout(function() {
      return _.on(Global.cache.phrase);
    }, 10000);
  },
  burger: function() {
    if ($(this).hasClass('on')) {
      return Global.menu.on();
    } else {
      return Global.menu.off();
    }
  },
  astro: function(clean) {
    if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50 && (Global.cache.astro.hasClass('off') || clean)) {
      _.on(Global.cache.astro, Global.cache.red1, Global.cache.burger, Global.cache.phrase);
      return true;
    }
    if ((document.body.scrollTop < 50 || document.documentElement.scrollTop < 50) && (Global.cache.astro.hasClass('on') || clean)) {
      _.off(Global.cache.astro, Global.cache.red1, Global.cache.burger, Global.cache.phrase);
      clearTimeout(Global.phraseTimeout);
      clearInterval(Global.phraseInterval);
      Global.phrase();
      return true;
    }
  },
  menu: {
    on: function() {
      _.on('.menu');
      _.off('.burger');
      return $('body').addClass('fixed');
    },
    off: function() {
      _.off('.menu');
      _.on('.burger');
      return $('body').removeClass('fixed');
    }
  },
  option: function() {
    var option, t;
    t = $(this);
    $('.menu > .inner > .options > .option').removeClass('active');
    t.addClass('active');
    option = t.text().trim();
    return setTimeout(function() {
      Global.menu.off();
      $('.menu > .inner > .options > .option').removeClass('active');
      if (option === 'work') {
        if (location.href.match('work') !== null) {
          Work.summary();
          _.on('.summary > .thumbs > .thumb');
          _.off('.summary > .filters > .inner > .filtermenu > .filter');
          _.on('.summary > .filters > .inner > .filtermenu > .filter_all');
        } else {
          location.href = '/work/';
        }
      }
      if (option === 'blog') {
        if (location.href.match('blog') !== null) {
          Blog.summary();
          _.on('.summary > .thumbs > .thumb');
          _.off('.summary > .filters > .inner > .filtermenu > .filter');
          _.on('.summary > .filters > .inner > .filtermenu > .filter_all');
        } else {
          location.href = '/blog/';
        }
      }
      if (option === 'about') {
        location.href = '/about/';
      }
      if (option === 'contact') {
        return location.href = '/contact/';
      }
    }, 400);
  },
  preload: function(srces, progress, complete) {
    var i, images, j, len, loaded, results, src, total;
    images = [];
    loaded = 0;
    total = srces.length;
    results = [];
    for (i = j = 0, len = srces.length; j < len; i = ++j) {
      src = srces[i];
      images[i] = new Image();
      images[i].src = src;
      results.push(images[i].onload = function() {
        var perc;
        loaded++;
        perc = Math.round(loaded / total * 100) / 100;
        if (loaded === total) {
          return complete(true);
        } else {
          return progress(perc);
        }
      });
    }
    return results;
  },
  srcFromStyle: function(el) {
    var style, url;
    style = el.attr('style');
    url = style.match(/url\((.*)\)/);
    if (url !== null && url[1] !== void 0) {
      return url[1].trim();
    } else {
      console.log('ERROR cannot find style for element', style);
      return console.log(url);
    }
  }
};

//# sourceMappingURL=data:application/json;base64,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QixDQUFBLEdBQTZCO1FBQ3BDLElBQUcsTUFBQSxLQUFVLEtBQWI7aUJBQXdCLFFBQUEsQ0FBUyxJQUFULEVBQXhCO1NBQUEsTUFBQTtpQkFBNEMsUUFBQSxDQUFTLElBQVQsRUFBNUM7O01BSGlCO0FBSHJCOztFQU5PLENBalJUO0VBK1JBLFlBQUEsRUFBYyxTQUFDLEVBQUQ7QUFDWixRQUFBO0lBQUEsS0FBQSxHQUFRLEVBQUUsQ0FBQyxJQUFILENBQVEsT0FBUjtJQUNSLEdBQUEsR0FBTSxLQUFLLENBQUMsS0FBTixDQUFZLGFBQVo7SUFDTixJQUFHLEdBQUEsS0FBUyxJQUFULElBQWtCLEdBQUksQ0FBQSxDQUFBLENBQUosS0FBWSxNQUFqQztBQUNFLGFBQU8sR0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFDLElBQVAsQ0FBQSxFQURUO0tBQUEsTUFBQTtNQUdFLE9BQU8sQ0FBQyxHQUFSLENBQVkscUNBQVosRUFBbUQsS0FBbkQ7YUFDQSxPQUFPLENBQUMsR0FBUixDQUFZLEdBQVosRUFKRjs7RUFIWSxDQS9SZCIsImZpbGUiOiJnbG9iYWwuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyJHbG9iYWwgPVxuXG4gIGFzdHJvSW50ZXJ2YWw6IGZhbHNlXG4gIGZiYXJJbnRlcnZhbDogZmFsc2VcbiAgcGhyYXNlVGltZW91dDogZmFsc2VcbiAgcGhyYXNlSW50ZXJ2YWw6IGZhbHNlXG4gIHRodW1iVGltZW91dDogZmFsc2VcbiAgY2FjaGU6IHt9XG5cbiAgaTogLT5cblxuICAgIE5Qcm9ncmVzcy5jb25maWd1cmVcbiAgICAgIHNob3dTcGlubmVyOiBmYWxzZVxuXG4gICAgR2xvYmFsLmNhY2hlLmFzdHJvID0gJCgnLmFzdHJvJylcbiAgICBHbG9iYWwuY2FjaGUucmVkMSA9ICQoJy5yZWQxJylcbiAgICBHbG9iYWwuY2FjaGUuYnVyZ2VyID0gJCgnLnRvcCA+IC5pbm5lciA+IC5idXJnZXIgPiAuaW5uZXInKVxuICAgIEdsb2JhbC5jYWNoZS5waHJhc2UgPSAkKCcudG9wID4gLmlubmVyID4gLnBocmFzZScpXG5cbiAgICBzZXRUaW1lb3V0IC0+XG4gICAgICBHbG9iYWwuYXN0cm8odHJ1ZSlcbiAgICAsIDQwMFxuXG4gICAgR2xvYmFsLmFzdHJvSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCAtPlxuICAgICAgR2xvYmFsLmFzdHJvKClcbiAgICAsIDUwMFxuXG4gICAgaWYgJCh3aW5kb3cpLndpZHRoKCkgPiAxMDAwXG4gICAgICBHbG9iYWwuZmJhckludGVydmFsID0gc2V0SW50ZXJ2YWwgLT5cbiAgICAgICAgR2xvYmFsLmZiYXIoKVxuICAgICAgLCAyMFxuXG4gICAgI0dsb2JhbC5waHJhc2UoKVxuXG4gICAgR2xvYmFsLmhhbmRsZXJzKClcblxuICAgIGlmICQod2luZG93KS53aWR0aCgpID4gMTAwMFxuICAgICAgR2xvYmFsLmZiYXIoKVxuXG4gIGZiYXI6IC0+XG5cbiAgICBpZiAkKCcuZmNvbnRhaW5lcjp2aXNpYmxlJykubGVuZ3RoIGlzIDBcbiAgICAgIHJldHVybiB0cnVlXG5cbiAgICBpZiAkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAoJCgnLmZjb250YWluZXI6dmlzaWJsZScpLm9mZnNldCgpLnRvcClcbiAgICAgICQoJy5maWx0ZXJzJykuYWRkQ2xhc3MgJ2Zsb2F0J1xuICAgIGVsc2VcbiAgICAgICQoJy5maWx0ZXJzJykucmVtb3ZlQ2xhc3MgJ2Zsb2F0J1xuXG4gICAgXG4gIGhhbmRsZXJzOiAtPlxuXG4gICAgJCgnLnRvcCA+IC5pbm5lciA+IC5idXJnZXInKS5vbiAnY2xpY2snLCBHbG9iYWwuYnVyZ2VyXG4gICAgJCgnLm1lbnUgPiAuaW5uZXIgPiAub3B0aW9ucyA+IC5vcHRpb24nKS5vbiAnY2xpY2snLCBHbG9iYWwub3B0aW9uXG5cbiAgICAkKCcudGh1bWJzID4gLnRodW1iLCAucHJvamVjdHMgPiAudGh1bWIsIC5yZWxhdGVkID4gLmlubmVyID4gLnJlbGF0ZWRzID4gLnRodW1iJykub24gJ21vdXNlbW92ZScsIEdsb2JhbC50aHVtYlxuXG4gICAgJCgnLmZvb3RlciA+IC5pbm5lciA+IC5ncmF2aXR5LCAuZm9vdGVyID4gLmlubmVyID4gLm1hbmlmZXN0byA+IC5pbm5lciA+IC5jbG9zZScpLm9uICdjbGljaycsIEdsb2JhbC5tYW5pZmVzdG9cblxuXG4gIG1hbmlmZXN0bzogLT5cblxuICAgIG1mID0gJCgnLm1hbmlmZXN0bycpXG5cbiAgICBpZiBtZi5oYXNDbGFzcyAnb24nXG4gICAgICAjJCgnYm9keScpLnJlbW92ZUNsYXNzICdmaXhlZCdcbiAgICAgIF8ub2ZmIG1mXG4gICAgZWxzZVxuICAgICAgIyQoJ2JvZHknKS5hZGRDbGFzcyAnZml4ZWQnXG4gICAgICBfLm9uIG1mXG5cbiAgdGh1bWI6IChldmVudCkgLT5cblxuICAgIHQgPSAkIHRoaXNcbiAgICBiZyA9IHQuZmluZCAnLmlubmVyJ1xuICAgIG5hbWUgPSB0LmZpbmQgJy5pbm5lciA+IC5iZyA+IC5jb3B5ID4gLm5hbWUnXG4gICAgZmlsdGVycyA9IHQuZmluZCAnLmlubmVyID4gLmJnID4gLmNvcHkgPiAuZmlsdGVycydcbiAgICByZWN0ID0gdFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgIG5hbWVSZWN0ID0gbmFtZVswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgIGZpbHRlcnNSZWN0ID0gZmlsdGVyc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuXG4gICAgZGlzdG9ydEJnID0gbmV3IERpc3RvcnRcbiAgICAgIHdpZHRoOiByZWN0LndpZHRoXG4gICAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0XG4gICAgICAkZWw6IGJnXG5cbiAgICBkaXN0b3J0TmFtZSA9IG5ldyBEaXN0b3J0XG4gICAgICB3aWR0aDogcmVjdC53aWR0aFxuICAgICAgaGVpZ2h0OiByZWN0LmhlaWdodFxuICAgICAgJGVsOiBuYW1lUmVjdFxuXG4gICAgZGlzdG9ydEZpbHRlcnMgPSBuZXcgRGlzdG9ydFxuICAgICAgd2lkdGg6IHJlY3Qud2lkdGhcbiAgICAgIGhlaWdodDogcmVjdC5oZWlnaHRcbiAgICAgICRlbDogZmlsdGVyc1JlY3RcblxuICAgIG9mZnNldCA9IHQub2Zmc2V0KClcbiAgICB4ID0gTWF0aC5mbG9vcihldmVudC5wYWdlWCAtIG9mZnNldC5sZWZ0KVxuICAgIHkgPSBNYXRoLmZsb29yKGV2ZW50LnBhZ2VZIC0gb2Zmc2V0LnRvcClcbiAgICBweCA9IE1hdGguZmxvb3IoeCAqIDEwMCAvIHQud2lkdGgoKSlcbiAgICBweSA9IE1hdGguZmxvb3IoeSAqIDEwMCAvIHQuaGVpZ2h0KCkpXG5cbiAgICBvcHg4ID0gKHB4LTUwKS84XG4gICAgb3B5OCA9IChweS01MCkvOFxuXG4gICAgb3B4NiA9IChweC01MCkvNFxuICAgIG9weTYgPSAocHktNTApLzRcblxuICAgIG9weDQgPSAocHgtNTApLzRcbiAgICBvcHk0ID0gKHB5LTUwKS80XG5cbiAgICBkaXN0b3J0QmcudG9wUmlnaHQueCAtPSBvcHk4XG4gICAgZGlzdG9ydEJnLnRvcFJpZ2h0LnkgLT0gb3B4OFxuXG4gICAgZGlzdG9ydEJnLnRvcExlZnQueCAtPSAtb3B5OFxuICAgIGRpc3RvcnRCZy50b3BMZWZ0LnkgLT0gLW9weDhcblxuICAgIGRpc3RvcnRCZy5ib3R0b21SaWdodC54IC09IC1vcHk4XG4gICAgZGlzdG9ydEJnLmJvdHRvbVJpZ2h0LnkgLT0gLW9weDhcblxuICAgIGRpc3RvcnRCZy5ib3R0b21MZWZ0LnggLT0gb3B5OFxuICAgIGRpc3RvcnRCZy5ib3R0b21MZWZ0LnkgLT0gb3B4OFxuXG4gICAgYmcuY3NzICd0cmFuc2Zvcm0nLCBkaXN0b3J0QmcudG9TdHJpbmcoKVxuXG4gICAgZGlzdG9ydE5hbWUudG9wUmlnaHQueCAtPSBvcHk0XG4gICAgZGlzdG9ydE5hbWUudG9wUmlnaHQueSAtPSBvcHg0XG5cbiAgICBkaXN0b3J0TmFtZS50b3BMZWZ0LnggLT0gLW9weTRcbiAgICBkaXN0b3J0TmFtZS50b3BMZWZ0LnkgLT0gLW9weDRcblxuICAgIGRpc3RvcnROYW1lLmJvdHRvbVJpZ2h0LnggLT0gLW9weTRcbiAgICBkaXN0b3J0TmFtZS5ib3R0b21SaWdodC55IC09IC1vcHg0XG5cbiAgICBkaXN0b3J0TmFtZS5ib3R0b21MZWZ0LnggLT0gb3B5NFxuICAgIGRpc3RvcnROYW1lLmJvdHRvbUxlZnQueSAtPSBvcHg0XG5cbiAgICBuYW1lLmNzcyAndHJhbnNmb3JtJywgZGlzdG9ydE5hbWUudG9TdHJpbmcoKVxuXG5cbiAgICBkaXN0b3J0RmlsdGVycy50b3BSaWdodC54IC09IG9weTZcbiAgICBkaXN0b3J0RmlsdGVycy50b3BSaWdodC55IC09IG9weDZcblxuICAgIGRpc3RvcnRGaWx0ZXJzLnRvcExlZnQueCAtPSAtb3B5NlxuICAgIGRpc3RvcnRGaWx0ZXJzLnRvcExlZnQueSAtPSAtb3B4NlxuXG4gICAgZGlzdG9ydEZpbHRlcnMuYm90dG9tUmlnaHQueCAtPSAtb3B5NlxuICAgIGRpc3RvcnRGaWx0ZXJzLmJvdHRvbVJpZ2h0LnkgLT0gLW9weDZcblxuICAgIGRpc3RvcnRGaWx0ZXJzLmJvdHRvbUxlZnQueCAtPSBvcHk2XG4gICAgZGlzdG9ydEZpbHRlcnMuYm90dG9tTGVmdC55IC09IG9weDZcblxuXG4gICAgZmlsdGVycy5jc3MgJ3RyYW5zZm9ybScsIGRpc3RvcnRGaWx0ZXJzLnRvU3RyaW5nKClcblxuICAjIyNcbiAgcGhyYXNlOiAtPlxuICAgIHBocmFzZSA9IHBocmFzZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnBocmFzZXMubGVuZ3RoKV1cbiAgICBjb21waWxlZCA9ICcnXG4gICAgZm9yIGkgaW4gWzAuLihwaHJhc2UubGVuZ3RoLTEpXVxuICAgICAgY29tcGlsZWQgID0gXCIje2NvbXBpbGVkfTxkaXY+I3twaHJhc2VbaV0ucmVwbGFjZSgnICcsICcmbmJzcDsnKX08L2Rpdj5cIlxuXG4gICAgR2xvYmFsLmNhY2hlLnBocmFzZS5odG1sIGNvbXBpbGVkXG5cbiAgICBHbG9iYWwucGhyYXNlVGltZW91dCA9IHNldFRpbWVvdXQgLT5cbiAgICAgIF8ub24gR2xvYmFsLmNhY2hlLnBocmFzZVxuICAgICwgNTAwMFxuICAjIyNcbiAgXG4gIHBocmFzZTogLT5cblxuICAgIHBocmFzZSA9IHBocmFzZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnBocmFzZXMubGVuZ3RoKV1cblxuICAgIGR1cmF0aW9uID0gMjAwMFxuICAgIGNoYXJzID0gcGhyYXNlLmxlbmd0aFxuICAgIGNoYXJEdXJhdGlvbiA9IE1hdGgucm91bmQgZHVyYXRpb24gLyBjaGFyc1xuICAgIGNoYXIgPSAwXG5cbiAgICBjb3VudGVyID0gMFxuICAgIG51bXMgPSBbJyEnLCdAJywnXycsJyMnLCclJywnXicsJyYnLCcqJywnXycsJygnLCcpJywnWycsJ10nLCdfJ11cbiAgICBudW1zTWF4ID0gbnVtcy5sZW5ndGgtMVxuXG4gICAgR2xvYmFsLmNhY2hlLnBocmFzZS50ZXh0ICcnXG4gICAgdGV4dCA9ICcnXG4gICAgR2xvYmFsLnBocmFzZUludGVydmFsID0gc2V0SW50ZXJ2YWwgLT5cblxuICAgICAgY291bnRlcisrXG4gICAgICBpZiBjb3VudGVyIGlzIDEwXG4gICAgICAgIEdsb2JhbC5jYWNoZS5waHJhc2UudGV4dCBcIiN7dGV4dH0je3BocmFzZVtjaGFyKytdfVwiXG4gICAgICAgIHRleHQgPSBHbG9iYWwuY2FjaGUucGhyYXNlLnRleHQoKVxuICAgICAgICBjb3VudGVyID0gMFxuICAgICAgZWxzZVxuICAgICAgICBHbG9iYWwuY2FjaGUucGhyYXNlLnRleHQgXCIje3RleHR9I3tudW1zW18ucmFuZCgwLG51bXNNYXgpXX1cIlxuXG5cbiAgICAgIGlmIGNoYXIgaXMgY2hhcnNcbiAgICAgICAgY2xlYXJJbnRlcnZhbCBHbG9iYWwucGhyYXNlSW50ZXJ2YWxcblxuICAgICwgY2hhckR1cmF0aW9uLzEwXG5cbiAgICBjb25zb2xlLmxvZyBkdXJhdGlvbiwgcGhyYXNlLmxlbmd0aCwgY2hhckR1cmF0aW9uLCBwaHJhc2VcblxuICAgIEdsb2JhbC5waHJhc2VUaW1lb3V0ID0gc2V0VGltZW91dCAtPlxuICAgICAgXy5vbiBHbG9iYWwuY2FjaGUucGhyYXNlXG4gICAgLCAxMDAwMFxuXG4gIGJ1cmdlcjogLT5cblxuICAgIGlmICQodGhpcykuaGFzQ2xhc3MgJ29uJ1xuICAgICAgR2xvYmFsLm1lbnUub24oKVxuICAgIGVsc2VcbiAgICAgIEdsb2JhbC5tZW51Lm9mZigpXG5cbiAgYXN0cm86IChjbGVhbikgLT5cblxuICAgIGlmIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID4gNTAgb3IgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA+IDUwIGFuZCAoR2xvYmFsLmNhY2hlLmFzdHJvLmhhc0NsYXNzKCdvZmYnKSBvciBjbGVhbilcbiAgICAgIF8ub24gR2xvYmFsLmNhY2hlLmFzdHJvLCBHbG9iYWwuY2FjaGUucmVkMSwgR2xvYmFsLmNhY2hlLmJ1cmdlciwgR2xvYmFsLmNhY2hlLnBocmFzZVxuICAgICAgcmV0dXJuIHRydWVcblxuICAgIGlmIChkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA8IDUwIG9yIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgPCA1MCkgYW5kIChHbG9iYWwuY2FjaGUuYXN0cm8uaGFzQ2xhc3MoJ29uJykgb3IgY2xlYW4pXG4gICAgICBfLm9mZiBHbG9iYWwuY2FjaGUuYXN0cm8sIEdsb2JhbC5jYWNoZS5yZWQxLCBHbG9iYWwuY2FjaGUuYnVyZ2VyLCBHbG9iYWwuY2FjaGUucGhyYXNlXG4gICAgICBjbGVhclRpbWVvdXQgR2xvYmFsLnBocmFzZVRpbWVvdXRcbiAgICAgIGNsZWFySW50ZXJ2YWwgR2xvYmFsLnBocmFzZUludGVydmFsXG4gICAgICBHbG9iYWwucGhyYXNlKClcbiAgICAgIHJldHVybiB0cnVlXG5cbiAgbWVudTpcblxuICAgIG9uOiAtPlxuICAgICAgXy5vbiAnLm1lbnUnXG4gICAgICBfLm9mZiAnLmJ1cmdlcidcbiAgICAgICQoJ2JvZHknKS5hZGRDbGFzcyAnZml4ZWQnXG5cbiAgICBvZmY6IC0+XG4gICAgICBfLm9mZiAnLm1lbnUnXG4gICAgICBfLm9uICcuYnVyZ2VyJ1xuICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzICdmaXhlZCdcblxuICBvcHRpb246IC0+XG5cbiAgICB0ID0gJCB0aGlzXG4gICAgJCgnLm1lbnUgPiAuaW5uZXIgPiAub3B0aW9ucyA+IC5vcHRpb24nKS5yZW1vdmVDbGFzcyAnYWN0aXZlJ1xuICAgIHQuYWRkQ2xhc3MgJ2FjdGl2ZSdcblxuICAgIG9wdGlvbiA9IHQudGV4dCgpLnRyaW0oKVxuICAgIHNldFRpbWVvdXQgLT5cblxuICAgICAgR2xvYmFsLm1lbnUub2ZmKClcbiAgICAgICQoJy5tZW51ID4gLmlubmVyID4gLm9wdGlvbnMgPiAub3B0aW9uJykucmVtb3ZlQ2xhc3MgJ2FjdGl2ZSdcblxuICAgICAgaWYgb3B0aW9uIGlzICd3b3JrJ1xuICAgICAgICBpZiBsb2NhdGlvbi5ocmVmLm1hdGNoKCd3b3JrJykgaXNudCBudWxsXG4gICAgICAgICAgV29yay5zdW1tYXJ5KClcbiAgICAgICAgICBfLm9uICcuc3VtbWFyeSA+IC50aHVtYnMgPiAudGh1bWInXG4gICAgICAgICAgXy5vZmYgJy5zdW1tYXJ5ID4gLmZpbHRlcnMgPiAuaW5uZXIgPiAuZmlsdGVybWVudSA+IC5maWx0ZXInXG4gICAgICAgICAgXy5vbiAnLnN1bW1hcnkgPiAuZmlsdGVycyA+IC5pbm5lciA+IC5maWx0ZXJtZW51ID4gLmZpbHRlcl9hbGwnXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gJy93b3JrLydcblxuICAgICAgaWYgb3B0aW9uIGlzICdibG9nJ1xuICAgICAgICBpZiBsb2NhdGlvbi5ocmVmLm1hdGNoKCdibG9nJykgaXNudCBudWxsXG4gICAgICAgICAgQmxvZy5zdW1tYXJ5KClcbiAgICAgICAgICBfLm9uICcuc3VtbWFyeSA+IC50aHVtYnMgPiAudGh1bWInXG4gICAgICAgICAgXy5vZmYgJy5zdW1tYXJ5ID4gLmZpbHRlcnMgPiAuaW5uZXIgPiAuZmlsdGVybWVudSA+IC5maWx0ZXInXG4gICAgICAgICAgXy5vbiAnLnN1bW1hcnkgPiAuZmlsdGVycyA+IC5pbm5lciA+IC5maWx0ZXJtZW51ID4gLmZpbHRlcl9hbGwnXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gJy9ibG9nLydcblxuICAgICAgaWYgb3B0aW9uIGlzICdhYm91dCdcbiAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gJy9hYm91dC8nXG4gICAgICBpZiBvcHRpb24gaXMgJ2NvbnRhY3QnXG4gICAgICAgICAgbG9jYXRpb24uaHJlZiA9ICcvY29udGFjdC8nXG5cbiAgICAsIDQwMFxuXG4gIHByZWxvYWQ6IChzcmNlcywgcHJvZ3Jlc3MsIGNvbXBsZXRlKSAtPlxuXG4gICAgaW1hZ2VzID0gW11cbiAgICBsb2FkZWQgPSAwXG4gICAgdG90YWwgPSBzcmNlcy5sZW5ndGhcblxuICAgIGZvciBzcmMsIGkgaW4gc3JjZXNcbiAgICAgIGltYWdlc1tpXSA9IG5ldyBJbWFnZSgpXG4gICAgICBpbWFnZXNbaV0uc3JjID0gc3JjXG4gICAgICBpbWFnZXNbaV0ub25sb2FkID0gLT5cbiAgICAgICAgbG9hZGVkKytcbiAgICAgICAgcGVyYyA9IE1hdGgucm91bmQobG9hZGVkL3RvdGFsKjEwMCkvMTAwXG4gICAgICAgIGlmIGxvYWRlZCBpcyB0b3RhbCB0aGVuIGNvbXBsZXRlKHRydWUpIGVsc2UgcHJvZ3Jlc3MocGVyYylcblxuICBzcmNGcm9tU3R5bGU6IChlbCkgLT5cbiAgICBzdHlsZSA9IGVsLmF0dHIgJ3N0eWxlJ1xuICAgIHVybCA9IHN0eWxlLm1hdGNoKC91cmxcXCgoLiopXFwpLylcbiAgICBpZiB1cmwgaXNudCBudWxsIGFuZCB1cmxbMV0gaXNudCB1bmRlZmluZWRcbiAgICAgIHJldHVybiB1cmxbMV0udHJpbSgpXG4gICAgZWxzZVxuICAgICAgY29uc29sZS5sb2cgJ0VSUk9SIGNhbm5vdCBmaW5kIHN0eWxlIGZvciBlbGVtZW50Jywgc3R5bGVcbiAgICAgIGNvbnNvbGUubG9nIHVybFxuIl19
