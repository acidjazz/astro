var Blog;

Blog = {
  hash: false,
  centry: false,
  title: false,
  i: function() {
    var entry;
    $('.thumbs > .thumb').sort(function(a, b) {
      return +b.dataset.cdate - +a.dataset.cdate;
    }).appendTo($('.thumbs'));
    if (Object.keys(entries).indexOf(location.hash.replace('#', '')) !== -1) {
      entry = location.hash.replace('#', '');
      Blog.centry = entry;
      Blog.load(entry);
    } else {
      Blog.summary();
    }
    document.body.scrollTop = document.documentElement.scrollTop = 0;
    return Blog.handlers();
  },
  handlers: function() {
    $('.blog > .summary > .thumbs > .thumb').on('click', Blog.entryHandler);
    $('.blog > .summary > .thumbs > .thumb, .related > .relateds > .thumb').on('click', Blog.entryHandler);
    $('.entry > .details > .tags a').on('click', Blog.tagHandler);
    $('.entry > .details > .author a').on('click', Blog.authorHandler);
    $('.entry > .details > .shares > .share').on('click', Blog.share);
    $('.blog > .summary > .crumb > .close').on('click', Blog.filterReset);
    return $(window).on('popstate', Blog.pop);
  },
  pop: function(e) {
    var entry;
    document.body.scrollTop = document.documentElement.scrollTop = 0;
    if (Object.keys(entries).indexOf(location.hash.replace('#', '')) !== -1) {
      entry = location.hash.replace('#', '');
      Blog.centry = entry;
      return Blog.load(entry);
    } else {
      return Blog.summary();
    }
  },
  share: function() {
    var i, t, type;
    t = $(this);
    type = t.data('type');
    if (type === 'link') {
      _.swap('.share_url');
      _.swap(t);
      i = t.parent().find('.share_url input').first();
      i.val(location.href);
      i[0].setSelectionRange(0, i[0].value.length);
      return true;
    }
    if (type === 'facebook') {
      window.open('https://www.facebook.com/sharer/sharer.php?u=' + location.href, 'Share on Facebook', 'width=626,height=438');
      return true;
    }
    if (type === 'twitter') {
      window.open('https://twitter.com/intent/tweet?url=' + encodeURIComponent(location.href) + '&text=' + encodeURIComponent(Blog.title), 'Share on Twitter', 'width=626,height=438');
      return true;
    }
  },
  filterReset: function() {
    var entry;
    _.off('.crumb');
    _.on('.thumb');
    entry = location.hash = '';
    return Blog.summary();
  },
  tagHandler: function() {
    var tag;
    tag = $(this).text();
    return Blog.tagFilter(tag);
  },
  authorHandler: function() {
    var tag;
    tag = $(this).text();
    return Blog.authorFilter(tag);
  },
  authorFilter: function(author) {
    Blog.summary();
    _.on('.crumb');
    $('.crumb > .copy > span.desc').text('Posts by ');
    $('.crumb > .copy > span.value').text(author);
    return $('.summary > .thumbs > .thumb').each(function(i, el) {
      if (author === $(el).data('author')) {
        return _.on($(el));
      } else {
        return _.off($(el));
      }
    });
  },
  tagFilter: function(tag) {
    Blog.summary();
    _.on('.crumb');
    $('.crumb > .copy > span.desc').text('Filtering by ');
    $('.crumb > .copy > span.value').text(tag);
    return $('.summary > .thumbs > .thumb').each(function(i, el) {
      var tags;
      tags = $(el).data('tags');
      console.log(tags);
      if (tags.indexOf(tag) !== -1) {
        return _.on($(el));
      } else {
        return _.off($(el));
      }
    });
  },
  entryHandler: function() {
    var entry;
    entry = $(this).data('entry');
    location.hash = entry;
    document.body.scrollTop = document.documentElement.scrollTop = 0;
    return Blog.load(entry);
  },
  summary: function() {
    var srcs;
    location.hash = '';
    setTimeout(function() {
      $('.orbit').removeClass(function(index, css) {
        return (css.match(/\borbit_\S+/g) || []).join(' ');
      });
      return $('.dbar').removeClass(function(index, css) {
        return (css.match(/\bbar_\S+/g) || []).join(' ');
      });
    }, 1000);
    _.off('.entry');
    _.on('.orbit');
    dbar.i();
    srcs = [];
    $('.summary > .thumbs > .thumb > .inner').each(function(i, el) {
      return srcs.push(Global.srcFromStyle($(el)));
    });
    return Global.preload(srcs, function(progress) {
      return dbar.perc(progress);
    }, function(complete) {
      dbar.d();
      _.off('.orbit');
      return _.on('.summary');
    });
  },
  load: function(entry) {
    var srcs;
    _.off('.entry, .summary');
    $('.orbit').addClass("orbit_" + entry);
    $('.dbar').addClass("bar_" + entry);
    _.on('.orbit');
    dbar.i();
    $('.dbar').addClass("bar_" + entry);
    srcs = Blog.srcs(entry);
    return Global.preload(srcs, function(progress) {
      return dbar.perc(progress);
    }, function(complete) {
      dbar.d();
      _.off('.orbit');
      _.on(".entry_" + entry);
      Blog.title = $(".entry_" + entry + " > .details > .copy > .name").text();
      return setTimeout(function() {
        $('.orbit').removeClass(function(index, css) {
          return (css.match(/\borbit_\S+/g) || []).join(' ');
        });
        return $('.dbar').removeClass(function(index, css) {
          return (css.match(/\bbar_\S+/g) || []).join(' ');
        });
      }, 1000);
    });
  },
  srcs: function(entry) {
    var srcs;
    srcs = [Global.srcFromStyle($(".entry_" + entry + " > .cover"))];
    $(".entry_" + entry + " .img").each(function(i, v) {
      return srcs.push(Global.srcFromStyle($(v)));
    });
    return srcs;
  }
};

//# sourceMappingURL=data:application/json;base64,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ZyA9XG4gIGhhc2g6IGZhbHNlXG4gIGNlbnRyeTogZmFsc2VcbiAgdGl0bGU6IGZhbHNlXG5cbiAgaTogLT5cblxuICAgICQoJy50aHVtYnMgPiAudGh1bWInKS5zb3J0IChhLCBiKSAtPlxuICAgICAgcmV0dXJuICtiLmRhdGFzZXQuY2RhdGUgLSArYS5kYXRhc2V0LmNkYXRlXG4gICAgLmFwcGVuZFRvICQoJy50aHVtYnMnKVxuXG4gICAgaWYgT2JqZWN0LmtleXMoZW50cmllcykuaW5kZXhPZihsb2NhdGlvbi5oYXNoLnJlcGxhY2UoJyMnLCcnKSkgaXNudCAtMVxuICAgICAgZW50cnkgPSBsb2NhdGlvbi5oYXNoLnJlcGxhY2UgJyMnLCAnJ1xuICAgICAgQmxvZy5jZW50cnkgPSBlbnRyeVxuICAgICAgQmxvZy5sb2FkIGVudHJ5XG4gICAgZWxzZVxuICAgICAgQmxvZy5zdW1tYXJ5KClcblxuICAgIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IDBcblxuICAgIEJsb2cuaGFuZGxlcnMoKVxuXG4gIGhhbmRsZXJzOiAtPlxuICAgICQoJy5ibG9nID4gLnN1bW1hcnkgPiAudGh1bWJzID4gLnRodW1iJykub24gJ2NsaWNrJywgQmxvZy5lbnRyeUhhbmRsZXJcbiAgICAkKCcuYmxvZyA+IC5zdW1tYXJ5ID4gLnRodW1icyA+IC50aHVtYiwgLnJlbGF0ZWQgPiAucmVsYXRlZHMgPiAudGh1bWInKS5vbiAnY2xpY2snLCBCbG9nLmVudHJ5SGFuZGxlclxuXG4gICAgJCgnLmVudHJ5ID4gLmRldGFpbHMgPiAudGFncyBhJykub24gJ2NsaWNrJywgQmxvZy50YWdIYW5kbGVyXG4gICAgJCgnLmVudHJ5ID4gLmRldGFpbHMgPiAuYXV0aG9yIGEnKS5vbiAnY2xpY2snLCBCbG9nLmF1dGhvckhhbmRsZXJcblxuICAgICQoJy5lbnRyeSA+IC5kZXRhaWxzID4gLnNoYXJlcyA+IC5zaGFyZScpLm9uICdjbGljaycsIEJsb2cuc2hhcmVcblxuICAgICQoJy5ibG9nID4gLnN1bW1hcnkgPiAuY3J1bWIgPiAuY2xvc2UnKS5vbiAnY2xpY2snLCBCbG9nLmZpbHRlclJlc2V0XG5cbiAgICAkKHdpbmRvdykub24gJ3BvcHN0YXRlJywgQmxvZy5wb3BcblxuICBwb3A6IChlKSAtPlxuXG4gICAgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID0gMFxuXG4gICAgaWYgT2JqZWN0LmtleXMoZW50cmllcykuaW5kZXhPZihsb2NhdGlvbi5oYXNoLnJlcGxhY2UoJyMnLCcnKSkgaXNudCAtMVxuICAgICAgZW50cnkgPSBsb2NhdGlvbi5oYXNoLnJlcGxhY2UgJyMnLCAnJ1xuICAgICAgQmxvZy5jZW50cnkgPSBlbnRyeVxuICAgICAgQmxvZy5sb2FkIGVudHJ5XG4gICAgZWxzZVxuICAgICAgQmxvZy5zdW1tYXJ5KClcblxuICBzaGFyZTogLT5cblxuICAgIHQgPSAkIHRoaXNcbiAgICB0eXBlID0gdC5kYXRhICd0eXBlJ1xuXG4gICAgaWYgdHlwZSA9PSAnbGluaydcbiAgICAgIF8uc3dhcCAnLnNoYXJlX3VybCdcbiAgICAgIF8uc3dhcCB0XG4gICAgICBpID0gdC5wYXJlbnQoKS5maW5kKCcuc2hhcmVfdXJsIGlucHV0JykuZmlyc3QoKVxuICAgICAgaS52YWwobG9jYXRpb24uaHJlZilcbiAgICAgIGlbMF0uc2V0U2VsZWN0aW9uUmFuZ2UoMCwgaVswXS52YWx1ZS5sZW5ndGgpXG4gICAgICAjSXRlbS5hZGRTaGFyZSgpXG4gICAgICByZXR1cm4gdHJ1ZVxuXG4gICAgaWYgdHlwZSA9PSAnZmFjZWJvb2snXG4gICAgICB3aW5kb3cub3BlbiAnaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3NoYXJlci9zaGFyZXIucGhwP3U9JyArIGxvY2F0aW9uLmhyZWYsICdTaGFyZSBvbiBGYWNlYm9vaycsICd3aWR0aD02MjYsaGVpZ2h0PTQzOCdcbiAgICAgICNJdGVtLmFkZFNoYXJlKClcbiAgICAgIHJldHVybiB0cnVlXG4gICAgaWYgdHlwZSA9PSAndHdpdHRlcidcbiAgICAgIHdpbmRvdy5vcGVuICdodHRwczovL3R3aXR0ZXIuY29tL2ludGVudC90d2VldD91cmw9JytlbmNvZGVVUklDb21wb25lbnQobG9jYXRpb24uaHJlZikrJyZ0ZXh0PScrZW5jb2RlVVJJQ29tcG9uZW50KEJsb2cudGl0bGUpLCAnU2hhcmUgb24gVHdpdHRlcicsICd3aWR0aD02MjYsaGVpZ2h0PTQzOCdcbiAgICAgICNJdGVtLmFkZFNoYXJlKClcbiAgICAgIHJldHVybiB0cnVlXG5cbiAgZmlsdGVyUmVzZXQ6IC0+XG4gICAgXy5vZmYgJy5jcnVtYidcbiAgICBfLm9uICcudGh1bWInXG4gICAgZW50cnkgPSBsb2NhdGlvbi5oYXNoID0gJydcbiAgICBCbG9nLnN1bW1hcnkoKVxuXG4gIHRhZ0hhbmRsZXI6IC0+XG4gICAgdGFnID0gJCh0aGlzKS50ZXh0KClcbiAgICBCbG9nLnRhZ0ZpbHRlciB0YWdcblxuICBhdXRob3JIYW5kbGVyOiAtPlxuICAgIHRhZyA9ICQodGhpcykudGV4dCgpXG4gICAgQmxvZy5hdXRob3JGaWx0ZXIgdGFnXG5cbiAgYXV0aG9yRmlsdGVyOiAoYXV0aG9yKSAtPlxuXG4gICAgQmxvZy5zdW1tYXJ5KClcblxuICAgIF8ub24gJy5jcnVtYidcbiAgICAkKCcuY3J1bWIgPiAuY29weSA+IHNwYW4uZGVzYycpLnRleHQgJ1Bvc3RzIGJ5ICdcbiAgICAkKCcuY3J1bWIgPiAuY29weSA+IHNwYW4udmFsdWUnKS50ZXh0IGF1dGhvclxuXG4gICAgJCgnLnN1bW1hcnkgPiAudGh1bWJzID4gLnRodW1iJykuZWFjaCAoaSwgZWwpIC0+XG4gICAgICBpZiBhdXRob3IgaXMgJChlbCkuZGF0YSAnYXV0aG9yJ1xuICAgICAgICBfLm9uICQoZWwpXG4gICAgICBlbHNlXG4gICAgICAgIF8ub2ZmICQoZWwpXG5cbiAgdGFnRmlsdGVyOiAodGFnKSAtPlxuXG4gICAgQmxvZy5zdW1tYXJ5KClcblxuICAgIF8ub24gJy5jcnVtYidcbiAgICAkKCcuY3J1bWIgPiAuY29weSA+IHNwYW4uZGVzYycpLnRleHQgJ0ZpbHRlcmluZyBieSAnXG4gICAgJCgnLmNydW1iID4gLmNvcHkgPiBzcGFuLnZhbHVlJykudGV4dCB0YWdcblxuICAgICQoJy5zdW1tYXJ5ID4gLnRodW1icyA+IC50aHVtYicpLmVhY2ggKGksIGVsKSAtPlxuICAgICAgdGFncyA9ICQoZWwpLmRhdGEgJ3RhZ3MnXG4gICAgICBjb25zb2xlLmxvZyB0YWdzXG4gICAgICBpZiB0YWdzLmluZGV4T2YodGFnKSBpc250IC0xXG4gICAgICAgIF8ub24gJChlbClcbiAgICAgIGVsc2VcbiAgICAgICAgXy5vZmYgJChlbClcblxuICBlbnRyeUhhbmRsZXI6IC0+XG5cbiAgICBlbnRyeSA9ICQodGhpcykuZGF0YSAnZW50cnknXG4gICAgI2hpc3RvcnkucHVzaFN0YXRlIG51bGwsIG51bGwsIFwiL2Jsb2cvIyN7ZW50cnl9XCJcbiAgICBsb2NhdGlvbi5oYXNoID0gZW50cnlcbiAgICBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgPSAwXG4gICAgQmxvZy5sb2FkIGVudHJ5XG5cbiAgc3VtbWFyeTogKCkgLT5cblxuXG5cbiAgICBsb2NhdGlvbi5oYXNoID0gJydcblxuICAgIHNldFRpbWVvdXQgLT5cbiAgICAgICQoJy5vcmJpdCcpLnJlbW92ZUNsYXNzIChpbmRleCwgY3NzKSAtPlxuICAgICAgICAoY3NzLm1hdGNoKC9cXGJvcmJpdF9cXFMrL2cpIG9yIFtdKS5qb2luICcgJ1xuICAgICAgJCgnLmRiYXInKS5yZW1vdmVDbGFzcyAoaW5kZXgsIGNzcykgLT5cbiAgICAgICAgKGNzcy5tYXRjaCgvXFxiYmFyX1xcUysvZykgb3IgW10pLmpvaW4gJyAnXG4gICAgLCAxMDAwXG5cbiAgICBfLm9mZiAnLmVudHJ5J1xuICAgIF8ub24gJy5vcmJpdCdcbiAgICBkYmFyLmkoKVxuXG4gICAgc3JjcyA9IFtdXG5cbiAgICAkKCcuc3VtbWFyeSA+IC50aHVtYnMgPiAudGh1bWIgPiAuaW5uZXInKS5lYWNoIChpLCBlbCkgLT5cbiAgICAgIHNyY3MucHVzaChHbG9iYWwuc3JjRnJvbVN0eWxlKCQoZWwpKSlcblxuXG4gICAgR2xvYmFsLnByZWxvYWQgc3JjcyxcbiAgICAgIChwcm9ncmVzcykgLT5cbiAgICAgICAgZGJhci5wZXJjIHByb2dyZXNzXG4gICAgICAsIChjb21wbGV0ZSkgLT5cbiAgICAgICAgZGJhci5kKClcbiAgICAgICAgXy5vZmYgJy5vcmJpdCdcbiAgICAgICAgXy5vbiAnLnN1bW1hcnknXG4gIGxvYWQ6IChlbnRyeSkgLT5cbiAgICBfLm9mZiAnLmVudHJ5LCAuc3VtbWFyeSdcblxuICAgICQoJy5vcmJpdCcpLmFkZENsYXNzIFwib3JiaXRfI3tlbnRyeX1cIlxuICAgICQoJy5kYmFyJykuYWRkQ2xhc3MgXCJiYXJfI3tlbnRyeX1cIlxuXG4gICAgXy5vbiAnLm9yYml0J1xuXG4gICAgZGJhci5pKClcbiAgICAkKCcuZGJhcicpLmFkZENsYXNzIFwiYmFyXyN7ZW50cnl9XCJcbiAgICBzcmNzID0gQmxvZy5zcmNzIGVudHJ5XG4gICAgR2xvYmFsLnByZWxvYWQgc3JjcyxcbiAgICAgIChwcm9ncmVzcykgLT5cbiAgICAgICAgZGJhci5wZXJjIHByb2dyZXNzXG4gICAgICAsIChjb21wbGV0ZSkgLT5cbiAgICAgICAgZGJhci5kKClcbiAgICAgICAgXy5vZmYgJy5vcmJpdCdcbiAgICAgICAgXy5vbiBcIi5lbnRyeV8je2VudHJ5fVwiXG5cbiAgICAgICAgQmxvZy50aXRsZSA9ICQoXCIuZW50cnlfI3tlbnRyeX0gPiAuZGV0YWlscyA+IC5jb3B5ID4gLm5hbWVcIikudGV4dCgpXG5cbiAgICAgICAgc2V0VGltZW91dCAtPlxuICAgICAgICAgICQoJy5vcmJpdCcpLnJlbW92ZUNsYXNzIChpbmRleCwgY3NzKSAtPlxuICAgICAgICAgICAgKGNzcy5tYXRjaCgvXFxib3JiaXRfXFxTKy9nKSBvciBbXSkuam9pbiAnICdcbiAgICAgICAgICAkKCcuZGJhcicpLnJlbW92ZUNsYXNzIChpbmRleCwgY3NzKSAtPlxuICAgICAgICAgICAgKGNzcy5tYXRjaCgvXFxiYmFyX1xcUysvZykgb3IgW10pLmpvaW4gJyAnXG4gICAgICAgICwgMTAwMFxuXG4gIHNyY3M6IChlbnRyeSkgLT5cbiAgICBzcmNzID0gW0dsb2JhbC5zcmNGcm9tU3R5bGUoJChcIi5lbnRyeV8je2VudHJ5fSA+IC5jb3ZlclwiKSldXG4gICAgJChcIi5lbnRyeV8je2VudHJ5fSAuaW1nXCIpLmVhY2ggKGksIHYpIC0+XG4gICAgICBzcmNzLnB1c2ggR2xvYmFsLnNyY0Zyb21TdHlsZSgkKHYpKVxuXG4gICAgcmV0dXJuIHNyY3NcblxuXG4iXX0=
