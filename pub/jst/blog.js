var Blog;

Blog = {
  hash: false,
  centry: false,
  title: false,
  i: function() {
    var entry;
    $('.thumbs > .thumb').sort(function(a, b) {
      return +b.dataset.cdate - +a.dataset.cdate;
    }).appendTo($('.thumbs'));
    if (Object.keys(entries).indexOf(location.hash.replace('#', '')) !== -1) {
      entry = location.hash.replace('#', '');
      Blog.centry = entry;
      Blog.load(entry);
    } else {
      Blog.summary();
    }
    document.body.scrollTop = document.documentElement.scrollTop = 0;
    return Blog.handlers();
  },
  handlers: function() {
    $('.blog > .summary > .thumbs > .thumb').on('click', Blog.entryHandler);
    $('.blog > .summary > .thumbs > .thumb, .related > .relateds > .thumb').on('click', Blog.entryHandler);
    $('.entry > .details > .tags a').on('click', Blog.tagHandler);
    $('.entry > .details > .author a').on('click', Blog.authorHandler);
    $('.entry > .details > .shares > .share').on('click', Blog.share);
    $('.blog > .summary > .crumb > .close').on('click', Blog.filterReset);
    return $(window).on('popstate', Blog.pop);
  },
  pop: function(e) {
    var entry;
    document.body.scrollTop = document.documentElement.scrollTop = 0;
    if (Object.keys(entries).indexOf(location.hash.replace('#', '')) !== -1) {
      entry = location.hash.replace('#', '');
      Blog.centry = entry;
      return Blog.load(entry);
    } else {
      return Blog.summary();
    }
  },
  share: function() {
    var i, t, type;
    t = $(this);
    type = t.data('type');
    if (type === 'link') {
      _.swap('.share_url');
      _.swap(t);
      i = t.parent().find('.share_url input').first();
      i.val(location.href);
      i[0].setSelectionRange(0, i[0].value.length);
      return true;
    }
    if (type === 'facebook') {
      window.open('https://www.facebook.com/sharer/sharer.php?u=' + location.href, 'Share on Facebook', 'width=626,height=438');
      return true;
    }
    if (type === 'twitter') {
      window.open('https://twitter.com/intent/tweet?url=' + encodeURIComponent(location.href) + '&text=' + encodeURIComponent(Blog.title), 'Share on Twitter', 'width=626,height=438');
      return true;
    }
  },
  filterReset: function() {
    var entry;
    _.off('.crumb');
    _.on('.thumb');
    entry = location.hash = '';
    return Blog.summary();
  },
  tagHandler: function() {
    var tag;
    tag = $(this).text();
    return Blog.tagFilter(tag);
  },
  authorHandler: function() {
    var tag;
    tag = $(this).text();
    return Blog.authorFilter(tag);
  },
  authorFilter: function(author) {
    Blog.summary();
    _.on('.crumb');
    $('.crumb > .copy > span.desc').text('Posts by ');
    $('.crumb > .copy > span.value').text(author);
    return $('.summary > .thumbs > .thumb').each(function(i, el) {
      if (author === $(el).data('author')) {
        return _.on($(el));
      } else {
        return _.off($(el));
      }
    });
  },
  tagFilter: function(tag) {
    Blog.summary();
    _.on('.crumb');
    $('.crumb > .copy > span.desc').text('Filtering by ');
    $('.crumb > .copy > span.value').text(tag);
    return $('.summary > .thumbs > .thumb').each(function(i, el) {
      var tags;
      tags = $(el).data('tags');
      console.log(tags);
      if (tags.indexOf(tag) !== -1) {
        return _.on($(el));
      } else {
        return _.off($(el));
      }
    });
  },
  entryHandler: function() {
    var entry;
    entry = $(this).data('entry');
    location.hash = entry;
    document.body.scrollTop = document.documentElement.scrollTop = 0;
    return Blog.load(entry);
  },
  summary: function() {
    var srcs;
    location.hash = '';
    $('.orbit').removeClass(function(index, css) {
      return (css.match(/\borbit_\S+/g) || []).join(' ');
    });
    $('#nprogress .bar').removeClass(function(index, css) {
      return (css.match(/\bbar__\S+/g) || []).join(' ');
    });
    _.off('.entry');
    _.on('.orbit');
    NProgress.start();
    srcs = [];
    $('.summary > .thumbs > .thumb > .inner').each(function(i, el) {
      return srcs.push(Global.srcFromStyle($(el)));
    });
    return Global.preload(srcs, function(progress) {
      return NProgress.set(progress);
    }, function(complete) {
      NProgress.done();
      _.off('.orbit');
      return _.on('.summary');
    });
  },
  load: function(entry) {
    var srcs;
    _.off('.entry, .summary');
    $('.orbit').addClass("orbit_" + entry);
    $('#nprogress .bar').addClass("bar_" + entry);
    _.on('.orbit');
    NProgress.start();
    $('#nprogress .bar').addClass("bar_" + entry);
    srcs = Blog.srcs(entry);
    return Global.preload(srcs, function(progress) {
      return NProgress.set(progress);
    }, function(complete) {
      NProgress.done();
      _.off('.orbit');
      _.on(".entry_" + entry);
      Blog.title = $(".entry_" + entry + " > .details > .copy > .name").text();
      $('.orbit').removeClass(function(index, css) {
        return (css.match(/\borbit_\S+/g) || []).join(' ');
      });
      return $('#nprogress .bar').removeClass(function(index, css) {
        return (css.match(/\bbar__\S+/g) || []).join(' ');
      });
    });
  },
  srcs: function(entry) {
    var srcs;
    srcs = [Global.srcFromStyle($(".entry_" + entry + " > .cover"))];
    $(".entry_" + entry + " .img").each(function(i, v) {
      return srcs.push(Global.srcFromStyle($(v)));
    });
    return srcs;
  }
};

//# sourceMappingURL=data:application/json;base64,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LENBQUMsRUFBRixDQUFLLFNBQUEsR0FBVSxLQUFmO01BRUEsSUFBSSxDQUFDLEtBQUwsR0FBYSxDQUFBLENBQUUsU0FBQSxHQUFVLEtBQVYsR0FBZ0IsNkJBQWxCLENBQStDLENBQUMsSUFBaEQsQ0FBQTtNQUViLENBQUEsQ0FBRSxRQUFGLENBQVcsQ0FBQyxXQUFaLENBQXdCLFNBQUMsS0FBRCxFQUFRLEdBQVI7ZUFDdEIsQ0FBQyxHQUFHLENBQUMsS0FBSixDQUFVLGNBQVYsQ0FBQSxJQUE2QixFQUE5QixDQUFpQyxDQUFDLElBQWxDLENBQXVDLEdBQXZDO01BRHNCLENBQXhCO2FBRUEsQ0FBQSxDQUFFLGlCQUFGLENBQW9CLENBQUMsV0FBckIsQ0FBaUMsU0FBQyxLQUFELEVBQVEsR0FBUjtlQUMvQixDQUFDLEdBQUcsQ0FBQyxLQUFKLENBQVUsYUFBVixDQUFBLElBQTRCLEVBQTdCLENBQWdDLENBQUMsSUFBakMsQ0FBc0MsR0FBdEM7TUFEK0IsQ0FBakM7SUFUQSxDQUhKO0VBWEksQ0FwSk47RUE4S0EsSUFBQSxFQUFNLFNBQUMsS0FBRDtBQUNKLFFBQUE7SUFBQSxJQUFBLEdBQU8sQ0FBQyxNQUFNLENBQUMsWUFBUCxDQUFvQixDQUFBLENBQUUsU0FBQSxHQUFVLEtBQVYsR0FBZ0IsV0FBbEIsQ0FBcEIsQ0FBRDtJQUNQLENBQUEsQ0FBRSxTQUFBLEdBQVUsS0FBVixHQUFnQixPQUFsQixDQUF5QixDQUFDLElBQTFCLENBQStCLFNBQUMsQ0FBRCxFQUFJLENBQUo7YUFDN0IsSUFBSSxDQUFDLElBQUwsQ0FBVSxNQUFNLENBQUMsWUFBUCxDQUFvQixDQUFBLENBQUUsQ0FBRixDQUFwQixDQUFWO0lBRDZCLENBQS9CO0FBR0EsV0FBTztFQUxILENBOUtOIiwiZmlsZSI6ImJsb2cuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyJCbG9nID1cbiAgaGFzaDogZmFsc2VcbiAgY2VudHJ5OiBmYWxzZVxuICB0aXRsZTogZmFsc2VcblxuICBpOiAtPlxuXG4gICAgJCgnLnRodW1icyA+IC50aHVtYicpLnNvcnQgKGEsIGIpIC0+XG4gICAgICByZXR1cm4gK2IuZGF0YXNldC5jZGF0ZSAtICthLmRhdGFzZXQuY2RhdGVcbiAgICAuYXBwZW5kVG8gJCgnLnRodW1icycpXG5cbiAgICBpZiBPYmplY3Qua2V5cyhlbnRyaWVzKS5pbmRleE9mKGxvY2F0aW9uLmhhc2gucmVwbGFjZSgnIycsJycpKSBpc250IC0xXG4gICAgICBlbnRyeSA9IGxvY2F0aW9uLmhhc2gucmVwbGFjZSAnIycsICcnXG4gICAgICBCbG9nLmNlbnRyeSA9IGVudHJ5XG4gICAgICBCbG9nLmxvYWQgZW50cnlcbiAgICBlbHNlXG4gICAgICBCbG9nLnN1bW1hcnkoKVxuXG4gICAgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID0gMFxuXG4gICAgQmxvZy5oYW5kbGVycygpXG5cbiAgaGFuZGxlcnM6IC0+XG4gICAgJCgnLmJsb2cgPiAuc3VtbWFyeSA+IC50aHVtYnMgPiAudGh1bWInKS5vbiAnY2xpY2snLCBCbG9nLmVudHJ5SGFuZGxlclxuICAgICQoJy5ibG9nID4gLnN1bW1hcnkgPiAudGh1bWJzID4gLnRodW1iLCAucmVsYXRlZCA+IC5yZWxhdGVkcyA+IC50aHVtYicpLm9uICdjbGljaycsIEJsb2cuZW50cnlIYW5kbGVyXG5cbiAgICAkKCcuZW50cnkgPiAuZGV0YWlscyA+IC50YWdzIGEnKS5vbiAnY2xpY2snLCBCbG9nLnRhZ0hhbmRsZXJcbiAgICAkKCcuZW50cnkgPiAuZGV0YWlscyA+IC5hdXRob3IgYScpLm9uICdjbGljaycsIEJsb2cuYXV0aG9ySGFuZGxlclxuXG4gICAgJCgnLmVudHJ5ID4gLmRldGFpbHMgPiAuc2hhcmVzID4gLnNoYXJlJykub24gJ2NsaWNrJywgQmxvZy5zaGFyZVxuXG4gICAgJCgnLmJsb2cgPiAuc3VtbWFyeSA+IC5jcnVtYiA+IC5jbG9zZScpLm9uICdjbGljaycsIEJsb2cuZmlsdGVyUmVzZXRcblxuICAgICQod2luZG93KS5vbiAncG9wc3RhdGUnLCBCbG9nLnBvcFxuXG4gIHBvcDogKGUpIC0+XG5cbiAgICBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgPSAwXG5cbiAgICBpZiBPYmplY3Qua2V5cyhlbnRyaWVzKS5pbmRleE9mKGxvY2F0aW9uLmhhc2gucmVwbGFjZSgnIycsJycpKSBpc250IC0xXG4gICAgICBlbnRyeSA9IGxvY2F0aW9uLmhhc2gucmVwbGFjZSAnIycsICcnXG4gICAgICBCbG9nLmNlbnRyeSA9IGVudHJ5XG4gICAgICBCbG9nLmxvYWQgZW50cnlcbiAgICBlbHNlXG4gICAgICBCbG9nLnN1bW1hcnkoKVxuXG4gIHNoYXJlOiAtPlxuXG4gICAgdCA9ICQgdGhpc1xuICAgIHR5cGUgPSB0LmRhdGEgJ3R5cGUnXG5cbiAgICBpZiB0eXBlID09ICdsaW5rJ1xuICAgICAgXy5zd2FwICcuc2hhcmVfdXJsJ1xuICAgICAgXy5zd2FwIHRcbiAgICAgIGkgPSB0LnBhcmVudCgpLmZpbmQoJy5zaGFyZV91cmwgaW5wdXQnKS5maXJzdCgpXG4gICAgICBpLnZhbChsb2NhdGlvbi5ocmVmKVxuICAgICAgaVswXS5zZXRTZWxlY3Rpb25SYW5nZSgwLCBpWzBdLnZhbHVlLmxlbmd0aClcbiAgICAgICNJdGVtLmFkZFNoYXJlKClcbiAgICAgIHJldHVybiB0cnVlXG5cbiAgICBpZiB0eXBlID09ICdmYWNlYm9vaydcbiAgICAgIHdpbmRvdy5vcGVuICdodHRwczovL3d3dy5mYWNlYm9vay5jb20vc2hhcmVyL3NoYXJlci5waHA/dT0nICsgbG9jYXRpb24uaHJlZiwgJ1NoYXJlIG9uIEZhY2Vib29rJywgJ3dpZHRoPTYyNixoZWlnaHQ9NDM4J1xuICAgICAgI0l0ZW0uYWRkU2hhcmUoKVxuICAgICAgcmV0dXJuIHRydWVcbiAgICBpZiB0eXBlID09ICd0d2l0dGVyJ1xuICAgICAgd2luZG93Lm9wZW4gJ2h0dHBzOi8vdHdpdHRlci5jb20vaW50ZW50L3R3ZWV0P3VybD0nK2VuY29kZVVSSUNvbXBvbmVudChsb2NhdGlvbi5ocmVmKSsnJnRleHQ9JytlbmNvZGVVUklDb21wb25lbnQoQmxvZy50aXRsZSksICdTaGFyZSBvbiBUd2l0dGVyJywgJ3dpZHRoPTYyNixoZWlnaHQ9NDM4J1xuICAgICAgI0l0ZW0uYWRkU2hhcmUoKVxuICAgICAgcmV0dXJuIHRydWVcblxuICBmaWx0ZXJSZXNldDogLT5cbiAgICBfLm9mZiAnLmNydW1iJ1xuICAgIF8ub24gJy50aHVtYidcbiAgICBlbnRyeSA9IGxvY2F0aW9uLmhhc2ggPSAnJ1xuICAgIEJsb2cuc3VtbWFyeSgpXG5cbiAgdGFnSGFuZGxlcjogLT5cbiAgICB0YWcgPSAkKHRoaXMpLnRleHQoKVxuICAgIEJsb2cudGFnRmlsdGVyIHRhZ1xuXG4gIGF1dGhvckhhbmRsZXI6IC0+XG4gICAgdGFnID0gJCh0aGlzKS50ZXh0KClcbiAgICBCbG9nLmF1dGhvckZpbHRlciB0YWdcblxuICBhdXRob3JGaWx0ZXI6IChhdXRob3IpIC0+XG5cbiAgICBCbG9nLnN1bW1hcnkoKVxuXG4gICAgXy5vbiAnLmNydW1iJ1xuICAgICQoJy5jcnVtYiA+IC5jb3B5ID4gc3Bhbi5kZXNjJykudGV4dCAnUG9zdHMgYnkgJ1xuICAgICQoJy5jcnVtYiA+IC5jb3B5ID4gc3Bhbi52YWx1ZScpLnRleHQgYXV0aG9yXG5cbiAgICAkKCcuc3VtbWFyeSA+IC50aHVtYnMgPiAudGh1bWInKS5lYWNoIChpLCBlbCkgLT5cbiAgICAgIGlmIGF1dGhvciBpcyAkKGVsKS5kYXRhICdhdXRob3InXG4gICAgICAgIF8ub24gJChlbClcbiAgICAgIGVsc2VcbiAgICAgICAgXy5vZmYgJChlbClcblxuICB0YWdGaWx0ZXI6ICh0YWcpIC0+XG5cbiAgICBCbG9nLnN1bW1hcnkoKVxuXG4gICAgXy5vbiAnLmNydW1iJ1xuICAgICQoJy5jcnVtYiA+IC5jb3B5ID4gc3Bhbi5kZXNjJykudGV4dCAnRmlsdGVyaW5nIGJ5ICdcbiAgICAkKCcuY3J1bWIgPiAuY29weSA+IHNwYW4udmFsdWUnKS50ZXh0IHRhZ1xuXG4gICAgJCgnLnN1bW1hcnkgPiAudGh1bWJzID4gLnRodW1iJykuZWFjaCAoaSwgZWwpIC0+XG4gICAgICB0YWdzID0gJChlbCkuZGF0YSAndGFncydcbiAgICAgIGNvbnNvbGUubG9nIHRhZ3NcbiAgICAgIGlmIHRhZ3MuaW5kZXhPZih0YWcpIGlzbnQgLTFcbiAgICAgICAgXy5vbiAkKGVsKVxuICAgICAgZWxzZVxuICAgICAgICBfLm9mZiAkKGVsKVxuXG4gIGVudHJ5SGFuZGxlcjogLT5cblxuICAgIGVudHJ5ID0gJCh0aGlzKS5kYXRhICdlbnRyeSdcbiAgICAjaGlzdG9yeS5wdXNoU3RhdGUgbnVsbCwgbnVsbCwgXCIvYmxvZy8jI3tlbnRyeX1cIlxuICAgIGxvY2F0aW9uLmhhc2ggPSBlbnRyeVxuICAgIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IDBcbiAgICBCbG9nLmxvYWQgZW50cnlcblxuICBzdW1tYXJ5OiAoKSAtPlxuXG5cblxuICAgIGxvY2F0aW9uLmhhc2ggPSAnJ1xuXG4gICAgJCgnLm9yYml0JykucmVtb3ZlQ2xhc3MgKGluZGV4LCBjc3MpIC0+XG4gICAgICAoY3NzLm1hdGNoKC9cXGJvcmJpdF9cXFMrL2cpIG9yIFtdKS5qb2luICcgJ1xuICAgICQoJyNucHJvZ3Jlc3MgLmJhcicpLnJlbW92ZUNsYXNzIChpbmRleCwgY3NzKSAtPlxuICAgICAgKGNzcy5tYXRjaCgvXFxiYmFyX19cXFMrL2cpIG9yIFtdKS5qb2luICcgJ1xuXG4gICAgXy5vZmYgJy5lbnRyeSdcbiAgICBfLm9uICcub3JiaXQnXG4gICAgTlByb2dyZXNzLnN0YXJ0KClcblxuICAgIHNyY3MgPSBbXVxuXG4gICAgJCgnLnN1bW1hcnkgPiAudGh1bWJzID4gLnRodW1iID4gLmlubmVyJykuZWFjaCAoaSwgZWwpIC0+XG4gICAgICBzcmNzLnB1c2goR2xvYmFsLnNyY0Zyb21TdHlsZSgkKGVsKSkpXG5cblxuICAgIEdsb2JhbC5wcmVsb2FkIHNyY3MsXG4gICAgICAocHJvZ3Jlc3MpIC0+XG4gICAgICAgIE5Qcm9ncmVzcy5zZXQgcHJvZ3Jlc3NcbiAgICAgICwgKGNvbXBsZXRlKSAtPlxuICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpXG4gICAgICAgIF8ub2ZmICcub3JiaXQnXG4gICAgICAgIF8ub24gJy5zdW1tYXJ5J1xuICBsb2FkOiAoZW50cnkpIC0+XG4gICAgXy5vZmYgJy5lbnRyeSwgLnN1bW1hcnknXG5cbiAgICAkKCcub3JiaXQnKS5hZGRDbGFzcyBcIm9yYml0XyN7ZW50cnl9XCJcbiAgICAkKCcjbnByb2dyZXNzIC5iYXInKS5hZGRDbGFzcyBcImJhcl8je2VudHJ5fVwiXG5cbiAgICBfLm9uICcub3JiaXQnXG5cbiAgICBOUHJvZ3Jlc3Muc3RhcnQoKVxuICAgICQoJyNucHJvZ3Jlc3MgLmJhcicpLmFkZENsYXNzIFwiYmFyXyN7ZW50cnl9XCJcbiAgICBzcmNzID0gQmxvZy5zcmNzIGVudHJ5XG4gICAgR2xvYmFsLnByZWxvYWQgc3JjcyxcbiAgICAgIChwcm9ncmVzcykgLT5cbiAgICAgICAgTlByb2dyZXNzLnNldCBwcm9ncmVzc1xuICAgICAgLCAoY29tcGxldGUpIC0+XG4gICAgICAgIE5Qcm9ncmVzcy5kb25lKClcbiAgICAgICAgXy5vZmYgJy5vcmJpdCdcbiAgICAgICAgXy5vbiBcIi5lbnRyeV8je2VudHJ5fVwiXG5cbiAgICAgICAgQmxvZy50aXRsZSA9ICQoXCIuZW50cnlfI3tlbnRyeX0gPiAuZGV0YWlscyA+IC5jb3B5ID4gLm5hbWVcIikudGV4dCgpXG5cbiAgICAgICAgJCgnLm9yYml0JykucmVtb3ZlQ2xhc3MgKGluZGV4LCBjc3MpIC0+XG4gICAgICAgICAgKGNzcy5tYXRjaCgvXFxib3JiaXRfXFxTKy9nKSBvciBbXSkuam9pbiAnICdcbiAgICAgICAgJCgnI25wcm9ncmVzcyAuYmFyJykucmVtb3ZlQ2xhc3MgKGluZGV4LCBjc3MpIC0+XG4gICAgICAgICAgKGNzcy5tYXRjaCgvXFxiYmFyX19cXFMrL2cpIG9yIFtdKS5qb2luICcgJ1xuXG4gIHNyY3M6IChlbnRyeSkgLT5cbiAgICBzcmNzID0gW0dsb2JhbC5zcmNGcm9tU3R5bGUoJChcIi5lbnRyeV8je2VudHJ5fSA+IC5jb3ZlclwiKSldXG4gICAgJChcIi5lbnRyeV8je2VudHJ5fSAuaW1nXCIpLmVhY2ggKGksIHYpIC0+XG4gICAgICBzcmNzLnB1c2ggR2xvYmFsLnNyY0Zyb21TdHlsZSgkKHYpKVxuXG4gICAgcmV0dXJuIHNyY3NcblxuXG4iXX0=
